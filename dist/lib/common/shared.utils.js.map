{"version":3,"file":"shared.utils.js","sourceRoot":"","sources":["../../../src/lib/common/shared.utils.ts"],"names":[],"mappings":"AAIA,MAAM,CAAC,MAAM,uBAAuB,GAAG,CAAC,EAAU,EAAE,EAAE;IACpD,OAAO,YAAY,EAAE,EAAE,CAAC;AAC1B,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAAC,MAA2B,EAAE,EAAE;IAChE,IAAI,CAAC,EAAE,EAAE;QACP,OAAO,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC;QAC1D,OAAO,IAAI,CAAC;KACb;IACD,MAAM,CAAC,uBAAuB,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,GAAG,IAAI,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;AACvE,CAAC,CAAA;AAED,MAAM,CAAC,MAAM,kBAAkB,GAAG,CAAC,cAAqC,EAAE,EAAE;IAC1E,MAAM,IAAI,GAAG,2BAA2B,CAAC;IACzC,MAAM,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;IAClC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;QACrB,IAAI;YACF,KAAK,MAAM,MAAM,IAAI,cAAc,EAAE;gBACnC,IAAI,CAAC,MAAM,EAAE;oBACX,OAAO,CAAC,KAAK,CAAC,yDAAyD,CAAC,CAAC;oBACzE,SAAS;iBACV;gBAED,kBAAkB,CAAC,MAAM,CAAC,CAAC;aAC5B;SACF;QAAC,OAAO,CAAC,EAAE;SACX;IACH,CAAC,CAAC,CAAC;IAEH,MAAM,CAAC,GAAG,QAAQ,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,MAAM,CAAC,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;IAC3C,CAAC,CAAC,IAAI,GAAG,iBAAiB,CAAC;IAC3B,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC;IAEf,MAAM,WAAW,GAAG,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;IAEtE,IAAI,WAAW,EAAE;QACf,CAAC,CAAC,GAAG,GAAG,0DAA0D,CAAC;KACpE;SAAM;QACL,CAAC,CAAC,GAAG,GAAG,qCAAqC,CAAC;KAC/C;IAED,MAAM,cAAc,GAAG,GAAG,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAE7D,IAAK,MAAc,EAAE,KAAK,KAAK,gBAAgB,EAAE;QAC/C,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;KACtE;SAAM;QACL,cAAc,EAAE,CAAC;KAClB;IACD,OAAO,IAAI,CAAC;AACd,CAAC,CAAA","sourcesContent":["import {YandexCounterConfig} from \"../yandexCounterConfig.service\";\r\n\r\nexport declare var Ya: any;\r\n\r\nexport const UtilsGetCounterNameById = (id: string) => {\r\n  return `yaCounter${id}`;\r\n}\r\n\r\nexport const UtilsCreateCounter = (config: YandexCounterConfig) => {\r\n  if (!Ya) {\r\n    console.error(`[Yandex.Metric] not exist 3DParty script`);\r\n    return null;\r\n  }\r\n  window[UtilsGetCounterNameById(config.id)] = new Ya.Metrika2(config);\r\n}\r\n\r\nexport const insertYandexMetric = (counterConfigs: YandexCounterConfig[]) => {\r\n  const name = 'yandex_metrika_callbacks2';\r\n  window[name] = window[name] || [];\r\n  window[name].push(() => {\r\n    try {\r\n      for (const config of counterConfigs) {\r\n        if (!config) {\r\n          console.error(`[insertYandexMetric] not exist config in counterConfigs`);\r\n          continue;\r\n        }\r\n\r\n        UtilsCreateCounter(config);\r\n      }\r\n    } catch (e) {\r\n    }\r\n  });\r\n\r\n  const n = document.getElementsByTagName('script')[0];\r\n  const s = document.createElement('script');\r\n  s.type = 'text/javascript';\r\n  s.async = true;\r\n\r\n  const alternative = counterConfigs.find(config => config.alternative);\r\n\r\n  if (alternative) {\r\n    s.src = 'https://cdn.jsdelivr.net/npm/yandex-metrica-watch/tag.js';\r\n  } else {\r\n    s.src = 'https://mc.yandex.ru/metrika/tag.js';\r\n  }\r\n\r\n  const insetScriptTag = () => n.parentNode.insertBefore(s, n);\r\n\r\n  if ((window as any)?.opera === '[object Opera]') {\r\n    document.addEventListener('DOMContentLoaded', insetScriptTag, false);\r\n  } else {\r\n    insetScriptTag();\r\n  }\r\n  return name;\r\n}\r\n"]}